!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).insights={})}(this,function(a){"use strict";function u(){return"undefined"!=typeof window}function s(){return location.protocol+"//"+location.host}function c(){if(u()){var t=document.referrer||"",e=s();return t.substr(0,e.length)===e}}function p(){return u()?{type:"locale",value:('"'===(t=void 0!==navigator.languages?navigator.languages[0]:navigator.language)[0]&&(t=t.substr(1)),0<t.length&&'"'===t[t.length-1]&&(t=t.substr(0,t.length-1)),(t&&5===t.length&&"-"===t[2]?t.substr(0,3)+t.substr(3).toLocaleUpperCase():t)||"<none>")}:{type:"locale",value:"<not-in-browser>"};var t}function h(){return u()?{type:"screen-type",value:(t=window.innerWidth)<=414?"XS":t<=800?"S":t<=1200?"M":t<=1600?"L":"XL"}:{type:"screen-type",value:"<not-in-browser>"};var t}function l(){return u()?c()?{type:"referrer",value:"<none>"}:{type:"referrer",value:document.referrer||"<none>"}:{type:"referrer",value:"<not-in-browser>"}}function g(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),!u())return{type:"path",value:"<not-in-browser>"};var a=window.location.pathname,r=window.location.hash,n=window.location.search;return t&&e?a+=r:t?a+=r.substr(0,r.length-n.length):e&&(a+=n),{type:"path",value:a}}function v(t,e){return{type:"transition",value:t+"  ->  "+e}}function d(t,e){return void 0===e&&(e=""),t<5e3?{type:"duration-interval",value:e+"< 5s"}:t<15e3?{type:"duration-interval",value:e+"< 15s"}:t<3e4?{type:"duration-interval",value:e+"< 30s"}:t<6e4?{type:"duration-interval",value:e+"< 1m"}:t<3e5?{type:"duration-interval",value:e+"< 5m"}:{type:"duration-interval",value:e+"> 5m"}}var t=Object.freeze({__proto__:null,locale:p,screenType:h,referrer:l,path:g,transition:v,durationInterval:d,os:function(){return{type:"os"}},browser:function(){return{type:"browser"}}}),r={};var n=(e.prototype.track=function(t){if(this.options.disabled||!u())return Promise.resolve();if(t.unique){var e=JSON.stringify(t);if(this.uniques[e])return Promise.resolve();this.uniques[e]=!0}var a={id:t.id,projectId:this.projectId};t.remove&&(a.remove=!0),t.parameters&&(a.parameters=t.parameters),t.update&&(a.update=!0);var r=new XMLHttpRequest;r.open("post","https://getinsights.io/app/tics",!0),r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(a))},e.prototype.trackPages=function(t){if(!u())return{stop:function(){}};if(this.trackPageData)return this.trackPageData.result;var e,a=setInterval(this.trackPageChange,2e3),r=t||{},n=r.hash,i=void 0!==n&&n,o=r.search,s=void 0!==o&&o;return this.trackPageData={hash:i,search:s,path:g(i,s).value,isOnFirstPage:!0,time:Date.now(),result:{stop:function(){clearInterval(a)}}},this.trackSinglePage(!0,this.trackPageData.path),e=this.trackLastPageTimeSpent,window.addEventListener("unload",e),this.trackPageData.result},e.prototype.getPreviousPage=function(t){var e=this.trackPageData&&this.trackPageData.path;return!t&&e?e:c()?document.referrer.replace(s(),""):document.referrer},e.prototype.trackPageChange=function(){if(this.trackPageData){var t=this.trackPageData,e=g(t.hash,t.search).value;e!==this.trackPageData.path&&this.trackSinglePage(!1,e)}},e.prototype.trackSinglePage=function(t,e){if(this.trackPageData){this.trackPageData.isOnFirstPage=t&&!c();var a=this.trackPageData,r=a.time,n=a.isOnFirstPage,i={path:e};n&&(i.uniqueViews=e,i.referrer=l(),i.locale=p(),i.screenType=h());var o=this.getPreviousPage(t);if(o&&o!==e&&(i.transitions=v(o,e),!n)){var s=Date.now();this.trackPageData.time=s,i.duration=d(s-r,o+" - ")}this.trackPageData.path=e,this.track({id:"page-views",parameters:i})}},e.prototype.trackLastPageTimeSpent=function(){var t=this.trackPageData&&this.trackPageData.time;if(t&&"function"==typeof navigator.sendBeacon&&!this.options.disabled&&this.trackPageData){var e=this.trackPageData,a=e.isOnFirstPage,r=e.path,n={};n.duration=d(Date.now()-t,r+" - ");var i=document.activeElement&&document.activeElement.href||"",o=s();i?"/"!==i[0]&&i.substr(0,o.length)!==s()&&(n.transitions=v(r,i)):n.bounces=a?"Yes":"No",navigator.sendBeacon=navigator.sendBeacon||function(t,e){var a=new XMLHttpRequest;a.open("post",t,!1),a.send(e)},navigator.sendBeacon("https://getinsights.io/app/tics",JSON.stringify({id:"page-views",projectId:this.projectId,parameters:n,update:!0}))}},e);function e(t,e){void 0===e&&(e=r),this.projectId=t,this.options=e,this.uniques={},this.trackPageData=null,this.trackPageChange=this.trackPageChange.bind(this),this.trackLastPageTimeSpent=this.trackLastPageTimeSpent.bind(this)}a.DEFAULT_APP=null,a.App=n,a.init=function(t,e){return!u()||a.DEFAULT_APP||(a.DEFAULT_APP=new n(t,e)),a.DEFAULT_APP},a.parameters=t,a.track=function(t){a.DEFAULT_APP&&u()&&a.DEFAULT_APP.track(t)},a.trackPages=function(t){return a.DEFAULT_APP&&u()?a.DEFAULT_APP.trackPages(t):{stop:function(){}}},Object.defineProperty(a,"__esModule",{value:!0})});